# MYSQL_USERS_SMAPLE
ეს არის MYSQL მონაცემთ ბაზისთვის განკუთვნილი ცხრილები.



შესავალი

# სარჩევი:


ცხრილები
KRN_PROPERTIES - პარამეტრების ცხრილი.
KRN_CLIENTS - კლიენტის პერსონალური მონაცემები
KRN_TOKENS - კლიენტის კოდები. ვერიფიკაციის, რესეტის, ტოკენი
KRN_USER - კლიენტის ლოგინი,პაროლი,სტატუსი,მცდელობების რაოდ.
KRN_USER_AUTH - კლიენტის ვერიფიკაციის ისტორია
KRN_USER_AUTH_TYPE - კლიენტის ვერიფიკაციის ტიპები
KRN_USER_STATUS - კლიენტის სტატუსები
ფუნქციები
F_CODE_GENERATOR - უნიკალური კოდის გენერირება სიგრძის მიხედვით
F_USER_AUTH - მომხმარებლის ვერიფიკაცია
F_USER_CREATE - მომხმარებლის შექმნა
პროცედურები
PR_USER_EXISTS - ამოწმებს მომხმარებელი თუ არსებობს
PR_PROPERTIES_CHECK - ამოწმებს პარამეტრების ცხრილს თუ არ არსებობს ქმნის, და 	ამოწმებს „PR_PROPERTIES_CHECK_NAME„-პროცედურით.
PR_PROPERTIES_CHECK_NAME - ამოწმებს პარამეტრების ცხრილში თუ არსებობს პარამეტრი 	და თუ არ არის აინსერტებს.
PR_RESET_USERS - არასანქცირებული მომხმარებლების ყოველდღიური რესეტისათვის, გადის 	„PR_PROPERTIES_CHECK„-პროცედურას, ასევე თუ მონაცემები არ არის ციფრი მაშინ 	წაშლის და თავიდან გაივლის „PR_PROPERTIES_CHECK„-პროცედურას.
ევენტები
E_RESET_USERS - არასანქცირებული მომხმარებლების მცდელობების რესეტი დეფაულტ მნიშვნელზე იძახებს „PR_RESET_USERS„ პროცედურას




# ცხრილები
KRN_PROPERTIES
პარამეტრების ცხრილი
'USER_ATTEMPTS1', 3, NULL, 'ვერიფიკაციის მაქსიმალური რაოდენობა'
'USER_ATTEMPTS2',3,NULL,'რესეტის/მეილის დამოწმების მაქსიმალური რაოდენობა'
'USER_E_CODE_LENGTH',7,NULL,'მომხმარებლის რეგისტრაციისას გაგზავნილი დამოწმების კოდის სიგრძე'



KRN_CLIENTS 
კლიენტის პერსონალური მონაცემები
აქ უნდა ჩაიწეროს ისეთი ინფორმაციები რაც კლიენტის შესახებ გვექნება 

ADDRESS - მისამართი
CREATE_DATE - შექმნის თარიღი
EMAIL - ე-მაილი
FIRST_NAME -სახელი
ID - უნიკალური
LAST_LOGIN - ბოლო ვერიფიკაცია
LAST_NAME - გვარი
USER_ID - მომხმარებლის იდ


KRN_TOKENS 
კლიენტის კოდები. ვერიფიკაციის, რესეტის, ტოკენი
მომხმარებლის პირველი რეგისტრაციის მეილის დამოწმების კოდიდან დაწყებული, პაროლის რესეტის, ან ორმაგი დაცვის ვერიფიკაციისთვის კოდების გამოსაყენებლად

ID - უნიკალური
RESET - აღდგენის კოდი
TOKEN - ტოკენი
USER_ID - მომხმარებლის იდ
VERIFY - ვერიფიკაციის კოდი

KRN_USER 
კლიენტის ლოგინი,პაროლი,სტატუსი,მცდელობების რაოდ.
ეს არის ის ცხრილი რომელზეც იქნება ყველაზე მეტი დატვირთვა ვერიფიკაციის ან კლიენტის არსებობის სანახავად

ATTEMPTS1 - ავტორიზაციის მცდელობების რაოდენობა
ATTEMPTS2 - ვერიფიკაციის/აღდგენის მცდელობების რაოდენობა
ID - უნიკალური
PASSWORD - პაროლი დაშიფრული
STATUS - სტატუსი
USERNAME - ლოგინი

KRN_USER_AUTH 
 კლიენტის ვერიფიკაციის ისტორია
ეს იქნება ვერიფიკაციების ისტორია, ანუ როდის რომელი ტოკენით სცადა ვერიფიკაცია და რა სტატუსი დაუბრუნა, ვერ შეძლო დაებლოკა თუ წარმატებით შევიდა

AUTH_TYPE -ვერიფიკაციის ტიპი
DATE - თარიღი
ID - უნიკალური
TOKEN - მოწყობილობის ტოკენი
USER_ID მომხმარებლის იდ

KRN_USER_AUTH_TYPE 
კლიენტის ვერიფიკაციის ტიპები
ეს ცხრილი იქნება ვერიფიკაციის სტატუსის განმსაზღვრელი, 1-ვერ გაიარა ვერიფიკაცია,2-დაებლოკა იუზერი 3- და ა.შ.

DESC - აღწერა
ID - უნიკალური
NAME - დასახელება

KRN_USER_STATUS
 კლიენტის სტატუსები
ეს არის მომხმარებლის მიმდინარე სტატუსი გამოვყოფ 4 ძირითად კომპონენტს

რეგისტრირებული - მომხმარებელს გავლილი აქვს რეგისტრაცია, მაგრამ ჯერ არ დაუმოწმებია მეილი და არ შეუვსია მომხმარებლის ძირითადი ინფორმაცია,(სახელი,პაროლი,მისამართო და ა.შ)
ავტორიზებული - მომხმარებელი აქტიურია, დასრულებული აქვს რეგისტრაციის ყველა ფაზა.
დაბლოკილი - მომხმარებელმა დასაშვებზე მეტჯერ შეიყვანა არასწორი პაროლი
სანქცირებული - მომხმარებელი ადმინისტრაციის მიერ დაიბლოკა, ვერ შეძლებს პაროლის აღდგენას ან ვერიფიკაციის გალას, მიმართოს ადმინისტრაციას.

DESC - აღწერა
ID - უნიკალური
NAME - დასახელება




# ფუნქციები
F_CODE_GENERATOR 
 უნიკალური კოდის გენერირება სიგრძის მიხედვით
ფუნქცია აბრუნებს სიგრძის მითითებით: დაშიფრულ, მიმდინარე თაიმსტემპს დამატებული რანდომ რიცხვი, მოჭრილი მითითებული სიგრძეზე.

F_USER_AUTH
 მომხმარებლის ვერიფიკაცია
აბრუნებს:
-1 მომხმარებელი ვერ მოიძებნა,
-2 მომხმარებელი დაბლოკილია ან სანქცირებულია
-3 პაროლი არ ემთხვევა
>0 მომხმარებლის იდ. მომხმარებელმა გაიარა ვერიფიკაცია.

-2; -3; >0 სამივე შემთხვევაში ინფორმაცია ჩაიწერება ვერიფიკაციების ცხრილში ().
-3 შემთხვევაში ვერიფიკაციის მცდელობების რაოდენობა ერთით შემცირდება, თუ გახდება 0-ის ტოლი მომხმარებლის სტატუსი შეიცვლება და გახდება დაბლოკილი.
>0 თუ გაივლის ვერიფიკაციას მომხმარებლის მცდელობების რაოდენობა გახდება მაქსიმუმის ტოლი.

F_USER_CREATE
 მომხმარებლის შექმნა
აბრუნებს:
-1 მომხმარებელი უკვე არსებობს
>0 მომხმარებლის უნიკალური იდ
აღწერა:
ფუნქციის გაშვებამდე გაუშვით პროცედურა „PR_PROPERTIES_CHECK„
მომხმარებელი თუ არ არსებობს, „KRN_USER„ ცხრილში ქმნის ახალ ჩანაწერს და მოაქვს ახალი იუზერის იდ, შემდეგ შექმნის ჩანაწერს კლიენტების და იუზერ ტოკენის ცხრილებში(KRN_TOKENS,KRN_CLIENTS ),

# პროცედურები
PR_USER_EXISTS 
 ამოწმებს მომხმარებელი თუ არსებობს

PR_PROPERTIES_CHECK
 ამოწმებს პარამეტრების ცხრილს თუ არ არსებობს ქმნის, და 	ამოწმებს „PR_PROPERTIES_CHECK_NAME„-პროცედურით.

PR_PROPERTIES_CHECK_NAME 
 ამოწმებს პარამეტრების ცხრილში თუ არსებობს პარამეტრი 	და თუ არ არის ან value სვეტი ნალი დახვდა აგზავნის წაშლის ბრძანებას და ამატებს თავიდან მითითებულ პარამეტრებით.

PR_RESET_USERS 
 არასანქცირებული მომხმარებლების ყოველდღიური რესეტისათვის, გადის „PR_PROPERTIES_CHECK„-პროცედურას, ასევე თუ მონაცემები არ არის ციფრი მაშინ წაშლის და თავიდან გაივლის „PR_PROPERTIES_CHECK„-პროცედურას.
მცდელობების პარამეტრები მაქვს „KRN_PROPERTIES„ ცხრილიდა.

# ევენტები
E_RESET_USERS - არასანქცირებული მომხმარებლების მცდელობების რესეტი დეფაულტ მნიშვნელზე იძახებს „PR_RESET_USERS„ პროცედურას
